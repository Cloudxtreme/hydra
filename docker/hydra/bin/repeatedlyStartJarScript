#!/bin/bash
# has to be in separate script (from hydra.sh) so it can be nohup'ed

source /opt/hydra/bin/hydra.sh

name=$1
while [ 1 == 1 ]; do
    startLoggedJar $*
    wait `cat "${HYDRA_PID}/$name.pid"`
    code=$?
    date
    echo "Exit code is ${code}"
    case ${code} in
        33) echo "Environment Failure or Generic Exception, restarting ..."; continue;;
        42) echo "restart on OOM exit..."; continue;;
        *) echo "normal exit"; exit ${code}; break;;
    esac
done